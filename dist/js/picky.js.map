{"version":3,"sources":["../../src/js/picky.js"],"names":[],"mappings":"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","file":"picky.js","sourcesContent":["// Expression for detecting of text input is a URL, then compile the regexp\nconst expression = /^[-a-zA-Z0-9@:%_\\+.~#?&//=]{2,256}\\.[a-z]{2,4}\\b(\\/[-a-zA-Z0-9@:%_\\+.~#?&//=]*)?/gi\nconst urlRegex = new RegExp(expression)\n\n// Initialise the main template with default data, then onrender retrieve from localStorage giving us a\n// native 'Application Shell' like experience\nconst main = new Highlight({\n  el: '#json',\n  debug: false\n})\n\n// Initialise the input template with localStorage data\nconst input = new Ractive({\n  el: '.grab',\n  template: templates.grab,\n  data: (localStorage.input ? JSON.parse(localStorage.getItem('input')) : {}),\n  onrender: () => {\n    const clipboard = new Clipboard('.btn-clipboard') // Stop crying Firefox!\n    clipboard // stop crying StandardJS!\n  }\n})\n\n// Initialise the Warning template in a Ractive template\nconst warning = new Ractive({\n  el: '.error-container',\n  template: templates.error,\n  data: { error: null }\n})\n\n// If a value was previously in textarea, put it back!\nif (localStorage.text) {\n  $('textarea').val(localStorage.getItem('text'))\n}\n\n// Format the path so that Ractive understands it\nconst formatSelected = (path) => {\n  return path.replace(/\\[/g, '.').replace(/\\]\\.?/g, '.').replace(/\\.$/, '')\n}\n\n// Format the JSON path so that it is valid for JS\nconst unformatSelected = (path) => {\n  return path.replace(/(^[0-9]+|\\.[0-9]+)\\.?/g, '[$1].') // Wraps number keys in brackets\n    .replace(/\\[\\./g, '\\[') // Removes fullstops from within brackets\n    .replace(/([a-z0-9]+\\-+[a-z0-9]+)\\.?/g, '[\"$1\"].') // Moves keys with dashes into square brackets\n    .replace(/\\]\\.\\[/g, '][') // replace full stops where two brackets are next to eachother\n    .replace(/\\.$/, '') // Gets rid of trailing full stop\n    .replace(/(\\[[0-9]*$)/, '$1]') // Adds the bracket to the end if needed\n    .replace(/(^[0-9]*\\])/, '[$1') // adds the bracket to the beginning if needed\n}\n\n// Triggered by a click event, gets us the clicked path name\nmain.on('showPath', (oldVal, newVal) => {\n  if (newVal) input.set('path', unformatSelected(newVal.replace(/^data./, '')))\n})\n\n// Keup event from the grab.handlebars input, highlights the typed value\ninput.on('highlight', function (el, value) {\n  main.set('isSelected', 'data.' + formatSelected(value).replace(/^\\./, ''))\n})\n\n// Load example data\n$('.btn-example').click(() => {\n  $('#picked').val('')\n  $.ajax({\n    url: 'https://maps.googleapis.com/maps/api/geocode/json?address=San%20Francisco',\n    success: (data) => {\n      $('textarea').val('https://maps.googleapis.com/maps/api/geocode/json?address=San%20Francisco')\n      main.set('isSelected', '')\n      warning.set({'error': null})\n      main.set({\n        data: JSON.parse(data)\n      })\n    },\n    dataType: 'text'\n  })\n})\n\n// Resize panels\nconst resizer = (offset, field, max) => {\n  if (100 - offset > max && offset > max) {\n    $('textarea').css(field, offset + '%')\n    $('.code-wrap').css(field, (100 - offset) + '%')\n  }\n}\n\n// On mousedown / touchstart show that we are in 'resizing mode'\nlet resizing = false\n$('.resize').on('mousedown touchstart', () => {\n  resizing = true\n})\n\n// On mousemove or touchmove i.e. dragging the resizer either horiz or vert depending on breakpoint i.e. 1000\n$(document).on('mousemove touchmove', (e) => {\n  if (!resizing) {\n    return\n  }\n  if (document.querySelector('body').clientWidth >= 1000) {\n    resizer((e.pageX / document.querySelector('main').clientWidth) * 100, 'width', 10)\n  } else {\n    resizer((((e.originalEvent.pageY || e.originalEvent.touches[0].pageY) / document.querySelector('body').clientHeight) * 100) - 5, 'height', 20)\n    return false\n  }\n}).on('mouseup touchend', () => {\n  resizing = false\n})\n\n// Remove the resize styles on window change so it doesn't get weird\n$(window).on('resize', () =>\n  $('textarea, .code-wrap').removeAttr('style')\n)\n\n// Checks to see if the selected picky value is in the data, if not it will will remove the highlighting\n// and value from the input.\nconst resetPickySelected = () => {\n  if (!input.get('path')) return\n\n  const path = formatSelected(input.get('path')).replace(/^\\./, '')\n  const checkMain = main.get(`data.${path}`)\n\n  if (typeof checkMain === 'undefined') {\n    main.set('isSelected', '')\n    input.set('path', '')\n  }\n}\n\n// If a user is typing text into the textarea which is\n// a largely different length then what we have already\n// it's a good chance that it's a large JSON object that\n// we'll need to debounce\nlet previousVal = ''\nlet textTimeout = ''\nconst debounceText = ($this, timeout) => {\n  textTimeout = setTimeout(() => {\n    try {\n      main.set({\n        data: JSON.parse($this.val()),\n        loading: false\n      }).then(() => {\n        warning.set('error', null)\n      })\n    } catch (error) {\n      if (!$this.val().length) {\n        main.set({data: '', loading: false})\n        warning.set({'error': null})\n        return\n      }\n\n      if (!$('textarea').val().match(urlRegex)) warning.set('error.invalidJSON', true)\n    }\n\n    previousVal = $this.val()\n    main.set('loading', false)\n    resetPickySelected()\n  }, timeout)\n}\n\n// If the user is typing a URL, debouncing is added to wait for\n// the user to finish typing\nlet requestTimeout = ''\nconst debounceRequest = (contents, timeout) => {\n  requestTimeout = setTimeout(() => {\n    if (!$('textarea').val().length) {\n      main.set('loading', false)\n      return\n    }\n\n    if (!$('textarea').val().match(urlRegex)) {\n      main.set({data: '', loading: false})\n      return\n    }\n\n    $.ajax({\n      url: contents,\n      type: 'GET',\n      dataType: 'json',\n      success: (data) => {\n        main.set({\n          data: typeof data === 'object' ? data : JSON.parse(data),\n          loading: false\n        })\n        warning.set({'error': null})\n      },\n      error: (e) => {\n        main.set({data: '', loading: false})\n        warning.set('error.code', e.status)\n      }\n    }).always(() => {\n      main.set('loading', false)\n      resetPickySelected()\n    })\n  }, timeout)\n}\n\nfunction keyupEvent (message) {\n  let text = $('textarea').val().trim()\n\n  if (text === previousVal) return\n\n  clearTimeout(requestTimeout)\n  clearTimeout(textTimeout)\n  if (text.match(urlRegex)) {\n    main.set('loading', true)\n    main.set('loadingMessage', 'Loading JSON from URL...')\n    debounceRequest(text, 2000)\n  } else {\n    if ($(this).val().length - previousVal.length > 500 || $(this).val().length - previousVal.length < -500) {\n      main.set('loading', true)\n      main.set('loadingMessage', message || 'Loading large JSON changes...')\n      debounceText($(this), 2000)\n    } else {\n      debounceText($(this), 0)\n    }\n  }\n\n  previousVal = text\n}\n\n// Test the input to see if it's a JSON url\n// If it is, populate <code> with that data\n// If it's not, populate <code> with whatever is in <textarea>\n$('textarea').on('keyup change', function (e) {\n  if (e.type === 'change') {\n    main.set('loading', true)\n    keyupEvent.call(this, 'Loading data from extension...')\n  } else {\n    keyupEvent.call(this)\n  }\n}).on('keydown', function (e) {\n  if (e.which === 9) {\n    e.preventDefault()\n    if (this.value) {\n      const val = this.value\n      const start = this.selectionStart\n      const end = this.selectionEnd\n      const selected = val.substring(start, end)\n      let re = ''\n      let count = ''\n\n      if (e.shiftKey) {\n        re = /^\\t/gm\n        count = -selected.match(re) ? selected.match(re).length : ''\n        this.value = val.substring(0, start) + selected.replace(re, '') + val.substring(end)\n      } else {\n        re = /^/gm\n        count = selected.match(re).length\n        this.value = val.substring(0, start) + selected.replace(re, '\\t') + val.substring(end)\n      }\n      if (start === end) {\n        this.selectionStart = end + count\n      } else {\n        this.selectionStart = start\n      }\n      this.selectionEnd = end + count\n    }\n  }\n\n  clearTimeout(requestTimeout)\n  clearTimeout(textTimeout)\n  main.set('loading', false)\n})\n\n// Before unload, stores everything in localstorage, the input will only get stored int he local storage\n// if there is both a textarea value and data in the main component\n$(window).on('beforeunload', () => {\n  localStorage.setItem('input', JSON.stringify($('textarea').val().length && main.get('data') ? input.get() : {}))\n  localStorage.setItem('text', $('textarea').val())\n})\n"]}