{"version":3,"sources":["../../src/js/picky.js"],"names":[],"mappings":"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","file":"picky.js","sourcesContent":["/* global Ractive, $, Clipboard */\n\n// Adds the commas after the attributes in the JSON\nRactive.defaults.data.pickyLengthCheck = function (keypath, index) {\n  const items = this.get(keypath.replace(/\\.[a-z\\_0-9]*$/gi, ''))\n  const length = Array.isArray(items) ? items.length : Object.keys(items).length\n  return index < length - 1\n}\n\nRactive.defaults.data.inArrayCheck = function (keypath, index) {\n  return !Array.isArray(this.get(keypath.replace(/\\.[0-9]*$/, '')))\n}\n\nRactive.DEBUG = false\n\nconst expression = /[-a-zA-Z0-9@:%_\\+.~#?&//=]{2,256}\\.[a-z]{2,4}\\b(\\/[-a-zA-Z0-9@:%_\\+.~#?&//=]*)?/gi\nconst regex = new RegExp(expression)\n\nconst main = new Ractive({\n  el: '.json',\n  template: '#main',\n  data: (localStorage.main ? JSON.parse(localStorage.getItem('main')) : {})\n})\n\nconst input = new Ractive({\n  el: '.grab',\n  template: '#grab',\n  data: (localStorage.input ? JSON.parse(localStorage.getItem('input')) : {}),\n  onrender: () => {\n    // Activate clipboard\n    const clipboard = new Clipboard('.btn-clipboard') // Stop crying Firefox!\n    clipboard // stop crying StandardJS!\n  }\n})\n\nif (localStorage.text) {\n  $('textarea').val(localStorage.getItem('text'))\n}\n\nconst formatSelected = (path) => {\n  return path.replace(/\\[/g, '.').replace(/\\]\\.?/g, '.').replace(/\\.$/, '')\n}\n\nconst unformatSelected = (path) => {\n  return path.replace(/\\.([0-9]+)/g, '[$1').replace(/([0-9]+)\\./g, '$1].').replace(/\\.$/, '').replace(/(\\[[0-9]*$)/, '$1]').replace(/(^[0-9]*\\])/, '[$1')\n}\n\nmain.on('showPath', function (el, path) {\n  this.set('pickyIsSelected', path)\n  input.set('path', unformatSelected(path.replace(/^data./, '')))\n})\n\ninput.on('highlight', function (el, value) {\n  main.set('pickyIsSelected', 'data.' + formatSelected(value))\n})\n\n// Test if JSON is valid and trigger notification if it's not\nconst validNotification = () => {\n  if ($('textarea').val() !== '' && !$('textarea').val().match(regex)) {\n    try {\n      $.parseJSON($('textarea').val())\n      $('.invalid-json').fadeOut()\n    } catch (err) {\n      $('.invalid-json').fadeIn()\n    }\n  } else {\n    $('.invalid-json').fadeOut()\n  }\n}\n\nsetInterval(validNotification, 500)\n\n// Load example data\n$('.btn-example').click(() => {\n  $('#picked').val('')\n  $.ajax({\n    url: 'https://maps.googleapis.com/maps/api/geocode/json?address=San%20Francisco',\n    success: (data) => {\n      $('textarea').val('https://maps.googleapis.com/maps/api/geocode/json?address=San%20Francisco')\n      main.set('pickyIsSelected', '')\n      main.reset({\n        data: JSON.parse(data)\n      })\n    },\n    dataType: 'text'\n  })\n})\n\n// Resize panels\nconst resizer = (offset, field, max) => {\n  if (100 - offset > max && offset > max) {\n    $('textarea').css(field, offset + '%')\n    $('.code-wrap').css(field, (100 - offset) + '%')\n  }\n}\n\nlet resizing = false\n$('.resize').on('mousedown touchstart', () => {\n  resizing = true\n})\n\n$(document).on('mousemove touchmove', (e) => {\n  if (!resizing) {\n    return\n  }\n  if (document.querySelector('body').clientWidth >= 1000) {\n    resizer((e.pageX / document.querySelector('main').clientWidth) * 100, 'width', 10)\n  } else {\n    resizer((((e.originalEvent.pageY || e.originalEvent.touches[0].pageY) / document.querySelector('body').clientHeight) * 100) - 5, 'height', 20)\n    return false\n  }\n}).on('mouseup touchend', () => {\n  resizing = false\n})\n\n// Remove the resize styles on window change so it doesn't get wierd\n$(window).on('resize', () =>\n  $('textarea, .code-wrap').removeAttr('style')\n)\n\n$('textarea').on('keydown', function (e) {\n  if (e.which === 9) {\n    e.preventDefault()\n    if (this.value) {\n      const val = this.value\n      const start = this.selectionStart\n      const end = this.selectionEnd\n      const selected = val.substring(start, end)\n      let re = ''\n      let count = ''\n\n      if (e.shiftKey) {\n        re = /^\\t/gm\n        count = -selected.match(re).length\n        this.value = val.substring(0, start) + selected.replace(re, '') + val.substring(end)\n      } else {\n        re = /^/gm\n        count = selected.match(re).length\n        this.value = val.substring(0, start) + selected.replace(re, '\\t') + val.substring(end)\n      }\n      if (start === end) {\n        this.selectionStart = end + count\n      } else {\n        this.selectionStart = start\n      }\n      this.selectionEnd = end + count\n    }\n  }\n}).on('keyup', function () {\n  try {\n    main.reset({\n      data: JSON.parse($(this).val())\n    })\n  } catch (error) {\n    if (!$(this).val().length) {\n      main.reset()\n    }\n  }\n})\n\nlet timeout = ''\nconst debounceRequest = (contents, timeout) => {\n  timeout = setTimeout(() => {\n\n    if (!$('textarea').val().length) return\n\n    if (!$('textarea').val().match(regex)) {\n      main.reset()\n      return\n    }\n\n    $.ajax({\n      url: contents,\n      type: 'GET',\n      dataType: 'json',\n      success: (data) => {\n        main.reset({\n          data: typeof data === 'object' ? data : JSON.parse(data)\n        })\n      },\n      error: () => {\n        // Send textarea code to highlight.js <code> container\n        console.log(`Sorry for spamming the 💩 out of your console! https://github.com/corysimmons/picky.json/issues/4`)\n        main.set($('textarea').val())\n      }\n    })\n  }, timeout)\n}\n\n// Test the input to see if it's a JSON url\n// If it is, populate <code> with that data\n// If it's not, populate <code> with whatever is in <textarea>\n$('textarea').on('keyup', () => {\n  let url = $('textarea').val().trim()\n\n  clearTimeout(timeout)\n  if (url.match(regex)) {\n    debounceRequest(url, 1000)\n  }\n\n  $('#picked').val('')\n\n}).on('keydown', () => {\n  clearTimeout(timeout)\n})\n\n// Before unload, stores everything in localstorage, the input will only get stored int he local storage\n// if there is both a textarea value and data in the main component\n$(window).on('beforeunload', () => {\n  localStorage.setItem('main', JSON.stringify(main.get() || {}))\n  localStorage.setItem('input', JSON.stringify($('textarea').val().length && main.get('data') ? input.get() : {}))\n  localStorage.setItem('text', $('textarea').val())\n})\n"]}